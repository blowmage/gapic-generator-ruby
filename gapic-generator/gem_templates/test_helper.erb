# frozen_string_literal: true

<%= render partial: "shared/license" %>

$LOAD_PATH.unshift File.expand_path("../lib", __dir__)
require "google/gapic/generators/<%= gem_name %>_generator"

require "minitest/autorun"
require "minitest/focus"

class GeneratorTest < Minitest::Test
  def proto_input service
    File.read "test/proto_input/#{service}.bin", mode: "rb"
  end

  def request service
    Google::Protobuf::Compiler::CodeGeneratorRequest.decode proto_input(service)
  end

  def api service
    Google::Gapic::Schema::Api.new request(service)
  end

  def expected_content filename
    File.read "test/expected_output/#{filename}"
  end
end
